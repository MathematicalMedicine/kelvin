#include <stdio.h>
#include <stdlib.h>
#include <math.h>

double interpolate (double xTarget, int tableSize, double *tableX, double *tableY) {

  // Handle boundary cases...
  if (xTarget <= tableX[0])
    return (tableY[0]);
  if (xTarget >= tableX[tableSize-1])
    return (tableY[tableSize-1]);

  // Simple binary search for largest tableX <= xTarget

  int i, lo = 0, hi = tableSize;
  do {
    i = ((hi - lo) / 2 + lo);
    if (xTarget < tableX[i])
      hi = i - 1;
    else
      if (xTarget > tableX[i+1])
	lo = i + 1;
      else
	return (tableY[i] + ((tableY[i+1]-tableY[i]) * ((xTarget-tableX[i]) / (tableX[i+1]-tableX[i]))));
  } while (1);
}


// Just calculate the probability density function given mean and stdDev
double gaussian_pdf (double x, double mean, double stdDev) {
  return (1/(stdDev*sqrt(2.0*M_PI)))*exp(-((x-mean)*(x-mean)/(2*stdDev*stdDev)));
}

// The CDF is table driven, translated by mean and scaled by stdDev
double gaussian_cdf (double x, double mean, double stdDev) {

  /*

  Table of cumulative distribution fuction X, Y pairs with mean of 0 and stdDev of .3.
  This X values are chosen to maintain a constant interval along the curve, i.e. the
  density is directly proportional to the slope. This allows accurate linear interpolation.

  */
  int TBL_VALUES = 251;
#define TBL_STDDEV (double) 0.2
  double X[251] = {
    -1,  -0.99,  -0.98,  -0.97,  -0.96,  -0.95,  -0.94,  -0.93,  -0.92,
    -0.91,  -0.9,  -0.89,  -0.88,  -0.87,  -0.86,  -0.85,  -0.84,  -0.83,  -0.82,
    -0.81,  -0.8,  -0.79,  -0.78,  -0.77,  -0.76,  -0.75,  -0.74,  -0.73,  -0.72,
    -0.71,  -0.7,  -0.69,  -0.68,  -0.67,  -0.66,  -0.65,  -0.64,  -0.63,  -0.62,
    -0.61,  -0.6,  -0.59,  -0.58,  -0.57,  -0.56,  -0.55,  -0.54,  -0.53,  -0.52,
    -0.51,  -0.5,  -0.49,  -0.48,  -0.47,  -0.46,  -0.45,  -0.44,  -0.43,  -0.42,
    -0.41,  -0.4,  -0.39,  -0.38,  -0.370087,  -0.360274,  -0.350581,  -0.34101,  -0.331581,  -0.322294,
    -0.313171,  -0.304208,  -0.295416,  -0.286792,  -0.278346,  -0.270074,  -0.261984,  -0.25407,  -0.246329,  -0.238756,
    -0.23134,  -0.224087,  -0.216984,  -0.210028,  -0.203215,  -0.196541,  -0.189995,  -0.183573,  -0.177265,  -0.17107,
    -0.164983,  -0.158995,  -0.153105,  -0.147302,  -0.141587,  -0.135949,  -0.130389,  -0.124898,  -0.119475,  -0.11412,
    -0.108824,  -0.103581,  -0.0983953,  -0.0932556,  -0.0881663,  -0.0831159,  -0.0781093,  -0.0731403,  -0.0682033,  -0.0632983,
    -0.0584246,  -0.0535768,  -0.0487546,  -0.0439528,  -0.0391712,  -0.0344095,  -0.0296626,  -0.0249304,  -0.0202078,  -0.0154949,
    -0.0107868,  -0.00608348,  -0.00138491,  0.00331365,  0.00801222,  0.0127108,  0.0174094,  0.0221079,  0.0268065,  0.0315051,
    0.0362036,  0.0409022,  0.0456008,  0.0502993,  0.0549979,  0.0596965,  0.064395,  0.0690936,  0.0737922,  0.0784907,
    0.0831893,  0.0878879,  0.0925864,  0.097285,  0.101984,  0.106712,  0.111486,  0.116308,  0.121177,  0.1261,
    0.131083,  0.136121,  0.141221,  0.14639,  0.151628,  0.156938,  0.162325,  0.167792,  0.173347,  0.178989,
    0.184723,  0.190555,  0.196488,  0.202525,  0.208674,  0.214938,  0.22132,  0.227829,  0.234467,  0.241238,
    0.248143,  0.255186,  0.26237,  0.269698,  0.277172,  0.284787,  0.292545,  0.300448,  0.308489,  0.31667,
    0.324983,  0.333419,  0.341979,  0.350653,  0.359424,  0.368291,  0.377246,  0.386278,  0.395378,  0.404546,
    0.413762,  0.423026,  0.432328,  0.44166,  0.451021,  0.46041,  0.469819,  0.479246,  0.488684,  0.49813,
    0.507587,  0.517053,  0.526528,  0.536003,  0.545479,  0.554964,  0.564448,  0.573933,  0.583418,  0.592903,
    0.602388,  0.611882,  0.621377,  0.630871,  0.640366,  0.64986,  0.659354,  0.668849,  0.678343,  0.687837,
    0.697332,  0.706826,  0.716321,  0.725815,  0.735309,  0.744804,  0.754298,  0.763793,  0.773287,  0.782781,
    0.792276,  0.80177,  0.811264,  0.820759,  0.830253,  0.839748,  0.849242,  0.858736,  0.868231,  0.877725,
    0.88722,  0.896714,  0.906208,  0.915703,  0.925197,  0.934691,  0.944186,  0.95368,  0.963175,  0.972669,
    0.982163,  0.991658};
  
  double Y[251] = {
    2.86652e-07,  3.71067e-07,  4.79183e-07,  6.17307e-07,  7.93328e-07,  1.01708e-06,  1.30081e-06,  1.65968e-06,  2.11245e-06,
    2.6823e-06,  3.39767e-06,  4.29351e-06,  5.41254e-06,  6.80688e-06,  8.53991e-06,  1.06885e-05,  1.33457e-05,  1.66238e-05,  2.06575e-05,
    2.56088e-05,  3.16712e-05,  3.90756e-05,  4.80963e-05,  5.90589e-05,  7.2348e-05,  8.84173e-05,  0.0001078,  0.00013112,  0.000159109,
    0.000192616,  0.000232629,  0.000280293,  0.000336929,  0.000404058,  0.000483424,  0.000577025,  0.000687138,  0.000816352,  0.000967603,
    0.00114421,  0.0013499,  0.00158887,  0.00186581,  0.00218596,  0.00255513,  0.00297976,  0.00346697,  0.00402459,  0.00466119,
    0.00538615,  0.00620967,  0.00714281,  0.00819754,  0.00938671,  0.0107241,  0.0122245,  0.0139034,  0.0157776,  0.0178644,
    0.0201822,  0.0227501,  0.0255881,  0.0287166,  0.0321254,  0.0358225,  0.0398092,  0.0440928,  0.0486684,  0.0535384,
    0.0586914,  0.0641248,  0.0698274,  0.0757919,  0.0820024,  0.0884485,  0.0951114,  0.10198,  0.109041,  0.116282,
    0.123698,  0.131265,  0.138979,  0.146827,  0.154797,  0.162876,  0.171063,  0.179345,  0.187721,  0.196179,
    0.20471,  0.213313,  0.22198,  0.230709,  0.239494,  0.248333,  0.257219,  0.266153,  0.275128,  0.284136,
    0.29318,  0.302263,  0.311368,  0.320508,  0.329667,  0.338859,  0.348066,  0.357294,  0.366545,  0.375815,
    0.385096,  0.394394,  0.403703,  0.413028,  0.422362,  0.4317,  0.441048,  0.4504,  0.45976,  0.469123,
    0.478494,  0.487867,  0.497238,  0.506609,  0.515978,  0.525337,  0.534683,  0.544009,  0.553312,  0.562585,
    0.571823,  0.581023,  0.590178,  0.599285,  0.608338,  0.617332,  0.626264,  0.635129,  0.643922,  0.652638,
    0.661275,  0.669828,  0.678293,  0.686667,  0.694945,  0.703177,  0.711384,  0.719561,  0.727704,  0.735816,
    0.743899,  0.751939,  0.759938,  0.7679,  0.775817,  0.783682,  0.791497,  0.799255,  0.806956,  0.814592,
    0.822156,  0.829648,  0.837059,  0.84438,  0.851612,  0.858743,  0.865766,  0.872678,  0.879469,  0.886127,
    0.892644,  0.89901,  0.905215,  0.91125,  0.917105,  0.922767,  0.928228,  0.933482,  0.938517,  0.943329,
    0.94791,  0.952252,  0.956357,  0.960222,  0.963842,  0.967223,  0.970368,  0.973283,  0.975973,  0.978449,
    0.980718,  0.982791,  0.984677,  0.986388,  0.987937,  0.989334,  0.99059,  0.991718,  0.992726,  0.993625,
    0.994425,  0.995135,  0.995764,  0.996319,  0.996808,  0.997238,  0.997616,  0.997945,  0.998233,  0.998484,
    0.998702,  0.998891,  0.999055,  0.999196,  0.999317,  0.999422,  0.999511,  0.999587,  0.999653,  0.999708,
    0.999755,  0.999795,  0.999829,  0.999858,  0.999882,  0.999902,  0.999919,  0.999933,  0.999945,  0.999955,
    0.999963,  0.999969,  0.999975,  0.99998,  0.999983,  0.999987,  0.999989,  0.999991,  0.999993,  0.999994,
    0.999995,  0.999996,  0.999997,  0.999998,  0.999998,  0.999999,  0.999999,  0.999999,  0.999999,  0.999999,
    1,  1};
  
  // Handle bad data first
  if (stdDev < 0.0)
    return ((double) -1);

  // Translation by mean and distortion by stdDev first...
  x = (x - mean) * TBL_STDDEV / stdDev;

  // Simple cases...
  if (x <= -1)
    return ((double) 0.0);
  if (x >= 1)
    return ((double) 1.0);

  // Not simple, do the lookup and interpolation

  return(interpolate (x, TBL_VALUES, X, Y));
}

double t_pdf (double x, double degFree) {
  int TBL_VALUES = 1001;
#define TBL_DEGFREE 30
  double X[1001] = {
    -5,  -4.99,  -4.98,  -4.97,  -4.96,  -4.95,  -4.94,  -4.93,  -4.92,
    -4.91,  -4.9,  -4.89,  -4.88,  -4.87,  -4.86,  -4.85,  -4.84,  -4.83,  -4.82,
    -4.81,  -4.8,  -4.79,  -4.78,  -4.77,  -4.76,  -4.75,  -4.74,  -4.73,  -4.72,
    -4.71,  -4.7,  -4.69,  -4.68,  -4.67,  -4.66,  -4.65,  -4.64,  -4.63,  -4.62,
    -4.61,  -4.6,  -4.59,  -4.58,  -4.57,  -4.56,  -4.55,  -4.54,  -4.53,  -4.52,
    -4.51,  -4.5,  -4.49,  -4.48,  -4.47,  -4.46,  -4.45,  -4.44,  -4.43,  -4.42,
    -4.41,  -4.4,  -4.39,  -4.38,  -4.37,  -4.36,  -4.35,  -4.34,  -4.33,  -4.32,
    -4.31,  -4.3,  -4.29,  -4.28,  -4.27,  -4.26,  -4.25,  -4.24,  -4.23,  -4.22,
    -4.21,  -4.2,  -4.19,  -4.18,  -4.17,  -4.16,  -4.15,  -4.14,  -4.13,  -4.12,
    -4.11,  -4.1,  -4.09,  -4.08,  -4.07,  -4.06,  -4.05,  -4.04,  -4.03,  -4.02,
    -4.01,  -4,  -3.99,  -3.98,  -3.97,  -3.96,  -3.95,  -3.94,  -3.93,  -3.92,
    -3.91,  -3.9,  -3.89,  -3.88,  -3.87,  -3.86,  -3.85,  -3.84,  -3.83,  -3.82,
    -3.81,  -3.8,  -3.79,  -3.78,  -3.77,  -3.76,  -3.75,  -3.74,  -3.73,  -3.72,
    -3.71,  -3.7,  -3.69,  -3.68,  -3.67,  -3.66,  -3.65,  -3.64,  -3.63,  -3.62,
    -3.61,  -3.6,  -3.59,  -3.58,  -3.57,  -3.56,  -3.55,  -3.54,  -3.53,  -3.52,
    -3.51,  -3.5,  -3.49,  -3.48,  -3.47,  -3.46,  -3.45,  -3.44,  -3.43,  -3.42,
    -3.41,  -3.4,  -3.39,  -3.38,  -3.37,  -3.36,  -3.35,  -3.34,  -3.33,  -3.32,
    -3.31,  -3.3,  -3.29,  -3.28,  -3.27,  -3.26,  -3.25,  -3.24,  -3.23,  -3.22,
    -3.21,  -3.2,  -3.19,  -3.18,  -3.17,  -3.16,  -3.15,  -3.14,  -3.13,  -3.12,
    -3.11,  -3.1,  -3.09,  -3.08,  -3.07,  -3.06,  -3.05,  -3.04,  -3.03,  -3.02,
    -3.01,  -3,  -2.99,  -2.98,  -2.97,  -2.96,  -2.95,  -2.94,  -2.93,  -2.92,
    -2.91,  -2.9,  -2.89,  -2.88,  -2.87,  -2.86,  -2.85,  -2.84,  -2.83,  -2.82,
    -2.81,  -2.8,  -2.79,  -2.78,  -2.77,  -2.76,  -2.75,  -2.74,  -2.73,  -2.72,
    -2.71,  -2.7,  -2.69,  -2.68,  -2.67,  -2.66,  -2.65,  -2.64,  -2.63,  -2.62,
    -2.61,  -2.6,  -2.59,  -2.58,  -2.57,  -2.56,  -2.55,  -2.54,  -2.53,  -2.52,
    -2.51,  -2.5,  -2.49,  -2.48,  -2.47,  -2.46,  -2.45,  -2.44,  -2.43,  -2.42,
    -2.41,  -2.4,  -2.39,  -2.38,  -2.37,  -2.36,  -2.35,  -2.34,  -2.33,  -2.32,
    -2.31,  -2.3,  -2.29,  -2.28,  -2.27,  -2.26,  -2.25,  -2.24,  -2.23,  -2.22,
    -2.21,  -2.2,  -2.19,  -2.18,  -2.17,  -2.16,  -2.15,  -2.14,  -2.13,  -2.12,
    -2.11,  -2.1,  -2.09,  -2.08,  -2.07,  -2.06,  -2.05,  -2.04,  -2.03,  -2.02,
    -2.01,  -2,  -1.99,  -1.98,  -1.97,  -1.96,  -1.95,  -1.94,  -1.93,  -1.92,
    -1.91,  -1.9,  -1.89,  -1.88,  -1.87,  -1.86,  -1.85,  -1.84,  -1.83,  -1.82,
    -1.81,  -1.8,  -1.79,  -1.78,  -1.77,  -1.76,  -1.75,  -1.74,  -1.73,  -1.72,
    -1.71,  -1.7,  -1.69,  -1.68,  -1.67,  -1.66,  -1.65,  -1.64,  -1.63,  -1.62,
    -1.61,  -1.6,  -1.59,  -1.58,  -1.57,  -1.56,  -1.55,  -1.54,  -1.53,  -1.52,
    -1.51,  -1.5,  -1.49,  -1.48,  -1.47,  -1.46,  -1.45,  -1.44,  -1.43,  -1.42,
    -1.41,  -1.4,  -1.39,  -1.38,  -1.37,  -1.36,  -1.35,  -1.34,  -1.33,  -1.32,
    -1.31,  -1.3,  -1.29,  -1.28,  -1.27,  -1.26,  -1.25,  -1.24,  -1.23,  -1.22,
    -1.21,  -1.2,  -1.19,  -1.18,  -1.17,  -1.16,  -1.15,  -1.14,  -1.13,  -1.12,
    -1.11,  -1.1,  -1.09,  -1.08,  -1.07,  -1.06,  -1.05,  -1.04,  -1.03,  -1.02,
    -1.01,  -1,  -0.99,  -0.98,  -0.97,  -0.96,  -0.95,  -0.94,  -0.93,  -0.92,
    -0.91,  -0.9,  -0.89,  -0.88,  -0.87,  -0.86,  -0.85,  -0.84,  -0.83,  -0.82,
    -0.81,  -0.8,  -0.79,  -0.78,  -0.77,  -0.76,  -0.75,  -0.74,  -0.73,  -0.72,
    -0.71,  -0.7,  -0.69,  -0.68,  -0.67,  -0.66,  -0.65,  -0.64,  -0.63,  -0.62,
    -0.61,  -0.6,  -0.59,  -0.58,  -0.57,  -0.56,  -0.55,  -0.54,  -0.53,  -0.52,
    -0.51,  -0.5,  -0.49,  -0.48,  -0.47,  -0.46,  -0.45,  -0.44,  -0.43,  -0.42,
    -0.41,  -0.4,  -0.39,  -0.38,  -0.37,  -0.36,  -0.35,  -0.34,  -0.33,  -0.32,
    -0.31,  -0.3,  -0.29,  -0.28,  -0.27,  -0.26,  -0.25,  -0.24,  -0.23,  -0.22,
    -0.21,  -0.2,  -0.19,  -0.18,  -0.17,  -0.16,  -0.15,  -0.14,  -0.13,  -0.12,
    -0.11,  -0.1,  -0.09,  -0.08,  -0.07,  -0.06,  -0.05,  -0.04,  -0.03,  -0.02,
    -0.01,  -1.06581e-13,  0.01,  0.02,  0.03,  0.04,  0.05,  0.06,  0.07,  0.08,
    0.09,  0.1,  0.11,  0.12,  0.13,  0.14,  0.15,  0.16,  0.17,  0.18,
    0.19,  0.2,  0.21,  0.22,  0.23,  0.24,  0.25,  0.26,  0.27,  0.28,
    0.29,  0.3,  0.31,  0.32,  0.33,  0.34,  0.35,  0.36,  0.37,  0.38,
    0.39,  0.4,  0.41,  0.42,  0.43,  0.44,  0.45,  0.46,  0.47,  0.48,
    0.49,  0.5,  0.51,  0.52,  0.53,  0.54,  0.55,  0.56,  0.57,  0.58,
    0.59,  0.6,  0.61,  0.62,  0.63,  0.64,  0.65,  0.66,  0.67,  0.68,
    0.69,  0.7,  0.71,  0.72,  0.73,  0.74,  0.75,  0.76,  0.77,  0.78,
    0.79,  0.8,  0.81,  0.82,  0.83,  0.84,  0.85,  0.86,  0.87,  0.88,
    0.89,  0.9,  0.91,  0.92,  0.93,  0.94,  0.95,  0.96,  0.97,  0.98,
    0.99,  1,  1.01,  1.02,  1.03,  1.04,  1.05,  1.06,  1.07,  1.08,
    1.09,  1.1,  1.11,  1.12,  1.13,  1.14,  1.15,  1.16,  1.17,  1.18,
    1.19,  1.2,  1.21,  1.22,  1.23,  1.24,  1.25,  1.26,  1.27,  1.28,
    1.29,  1.3,  1.31,  1.32,  1.33,  1.34,  1.35,  1.36,  1.37,  1.38,
    1.39,  1.4,  1.41,  1.42,  1.43,  1.44,  1.45,  1.46,  1.47,  1.48,
    1.49,  1.5,  1.51,  1.52,  1.53,  1.54,  1.55,  1.56,  1.57,  1.58,
    1.59,  1.6,  1.61,  1.62,  1.63,  1.64,  1.65,  1.66,  1.67,  1.68,
    1.69,  1.7,  1.71,  1.72,  1.73,  1.74,  1.75,  1.76,  1.77,  1.78,
    1.79,  1.8,  1.81,  1.82,  1.83,  1.84,  1.85,  1.86,  1.87,  1.88,
    1.89,  1.9,  1.91,  1.92,  1.93,  1.94,  1.95,  1.96,  1.97,  1.98,
    1.99,  2,  2.01,  2.02,  2.03,  2.04,  2.05,  2.06,  2.07,  2.08,
    2.09,  2.1,  2.11,  2.12,  2.13,  2.14,  2.15,  2.16,  2.17,  2.18,
    2.19,  2.2,  2.21,  2.22,  2.23,  2.24,  2.25,  2.26,  2.27,  2.28,
    2.29,  2.3,  2.31,  2.32,  2.33,  2.34,  2.35,  2.36,  2.37,  2.38,
    2.39,  2.4,  2.41,  2.42,  2.43,  2.44,  2.45,  2.46,  2.47,  2.48,
    2.49,  2.5,  2.51,  2.52,  2.53,  2.54,  2.55,  2.56,  2.57,  2.58,
    2.59,  2.6,  2.61,  2.62,  2.63,  2.64,  2.65,  2.66,  2.67,  2.68,
    2.69,  2.7,  2.71,  2.72,  2.73,  2.74,  2.75,  2.76,  2.77,  2.78,
    2.79,  2.8,  2.81,  2.82,  2.83,  2.84,  2.85,  2.86,  2.87,  2.88,
    2.89,  2.9,  2.91,  2.92,  2.93,  2.94,  2.95,  2.96,  2.97,  2.98,
    2.99,  3,  3.01,  3.02,  3.03,  3.04,  3.05,  3.06,  3.07,  3.08,
    3.09,  3.1,  3.11,  3.12,  3.13,  3.14,  3.15,  3.16,  3.17,  3.18,
    3.19,  3.2,  3.21,  3.22,  3.23,  3.24,  3.25,  3.26,  3.27,  3.28,
    3.29,  3.3,  3.31,  3.32,  3.33,  3.34,  3.35,  3.36,  3.37,  3.38,
    3.39,  3.4,  3.41,  3.42,  3.43,  3.44,  3.45,  3.46,  3.47,  3.48,
    3.49,  3.5,  3.51,  3.52,  3.53,  3.54,  3.55,  3.56,  3.57,  3.58,
    3.59,  3.6,  3.61,  3.62,  3.63,  3.64,  3.65,  3.66,  3.67,  3.68,
    3.69,  3.7,  3.71,  3.72,  3.73,  3.74,  3.75,  3.76,  3.77,  3.78,
    3.79,  3.8,  3.81,  3.82,  3.83,  3.84,  3.85,  3.86,  3.87,  3.88,
    3.89,  3.9,  3.91,  3.92,  3.93,  3.94,  3.95,  3.96,  3.97,  3.98,
    3.99,  4,  4.01,  4.02,  4.03,  4.04,  4.05,  4.06,  4.07,  4.08,
    4.09,  4.1,  4.11,  4.12,  4.13,  4.14,  4.15,  4.16,  4.17,  4.18,
    4.19,  4.2,  4.21,  4.22,  4.23,  4.24,  4.25,  4.26,  4.27,  4.28,
    4.29,  4.3,  4.31,  4.32,  4.33,  4.34,  4.35,  4.36,  4.37,  4.38,
    4.39,  4.4,  4.41,  4.42,  4.43,  4.44,  4.45,  4.46,  4.47,  4.48,
    4.49,  4.5,  4.51,  4.52,  4.53,  4.54,  4.55,  4.56,  4.57,  4.58,
    4.59,  4.6,  4.61,  4.62,  4.63,  4.64,  4.65,  4.66,  4.67,  4.68,
    4.69,  4.7,  4.71,  4.72,  4.73,  4.74,  4.75,  4.76,  4.77,  4.78,
    4.79,  4.8,  4.81,  4.82,  4.83,  4.84,  4.85,  4.86,  4.87,  4.88,
    4.89,  4.9,  4.91,  4.92,  4.93,  4.94,  4.95,  4.96,  4.97,  4.98,
    4.99,  5};

  double Y[1001] = {
    3.28889e-05,  3.38289e-05,  3.47955e-05,  3.57896e-05,  3.68119e-05,  3.78631e-05,  3.89442e-05,  4.00559e-05,  4.11991e-05,
    4.23746e-05,  4.35834e-05,  4.48264e-05,  4.61046e-05,  4.74189e-05,  4.87703e-05,  5.01599e-05,  5.15888e-05,  5.30579e-05,  5.45685e-05,
    5.61217e-05,  5.77187e-05,  5.93607e-05,  6.10489e-05,  6.27846e-05,  6.45691e-05,  6.64038e-05,  6.82901e-05,  7.02293e-05,  7.2223e-05,
    7.42727e-05,  7.63798e-05,  7.8546e-05,  8.07729e-05,  8.30622e-05,  8.54155e-05,  8.78347e-05,  9.03215e-05,  9.28778e-05,  9.55055e-05,
    9.82065e-05,  0.000100983,  0.000103837,  0.00010677,  0.000109785,  0.000112884,  0.000116069,  0.000119342,  0.000122707,  0.000126165,
    0.000129719,  0.000133371,  0.000137125,  0.000140982,  0.000144947,  0.00014902,  0.000153207,  0.000157509,  0.00016193,  0.000166472,
    0.00017114,  0.000175937,  0.000180865,  0.000185929,  0.000191132,  0.000196478,  0.00020197,  0.000207613,  0.000213411,  0.000219367,
    0.000225486,  0.000231773,  0.000238231,  0.000244865,  0.00025168,  0.000258681,  0.000265872,  0.000273259,  0.000280846,  0.00028864,
    0.000296644,  0.000304866,  0.00031331,  0.000321983,  0.00033089,  0.000340037,  0.000349431,  0.000359079,  0.000368986,  0.000379159,
    0.000389606,  0.000400334,  0.000411349,  0.000422659,  0.000434272,  0.000446195,  0.000458437,  0.000471006,  0.000483909,  0.000497156,
    0.000510756,  0.000524716,  0.000539048,  0.000553759,  0.00056886,  0.00058436,  0.00060027,  0.0006166,  0.000633361,  0.000650563,
    0.000668217,  0.000686335,  0.000704929,  0.00072401,  0.00074359,  0.000763682,  0.000784299,  0.000805454,  0.00082716,  0.000849431,
    0.00087228,  0.000895722,  0.000919772,  0.000944444,  0.000969754,  0.000995717,  0.00102235,  0.00104967,  0.00107769,  0.00110643,
    0.00113591,  0.00116614,  0.00119714,  0.00122894,  0.00126154,  0.00129498,  0.00132927,  0.00136442,  0.00140047,  0.00143743,
    0.00147532,  0.00151417,  0.001554,  0.00159483,  0.00163668,  0.00167959,  0.00172356,  0.00176864,  0.00181484,  0.00186219,
    0.00191072,  0.00196046,  0.00201142,  0.00206365,  0.00211717,  0.002172,  0.00222819,  0.00228576,  0.00234473,  0.00240516,
    0.00246706,  0.00253046,  0.00259542,  0.00266195,  0.00273009,  0.00279989,  0.00287137,  0.00294457,  0.00301954,  0.00309631,
    0.00317492,  0.00325541,  0.00333782,  0.0034222,  0.00350859,  0.00359702,  0.00368755,  0.00378022,  0.00387508,  0.00397216,
    0.00407153,  0.00417323,  0.00427731,  0.00438381,  0.0044928,  0.00460431,  0.00471842,  0.00483516,  0.00495459,  0.00507677,
    0.00520176,  0.00532962,  0.00546039,  0.00559415,  0.00573095,  0.00587086,  0.00601393,  0.00616023,  0.00630983,  0.00646279,
    0.00661918,  0.00677906,  0.00694251,  0.00710959,  0.00728038,  0.00745495,  0.00763337,  0.00781571,  0.00800206,  0.00819248,
    0.00838706,  0.00858587,  0.008789,  0.00899652,  0.00920851,  0.00942507,  0.00964628,  0.00987221,  0.010103,  0.0103386,
    0.0105793,  0.010825,  0.0110759,  0.0113321,  0.0115937,  0.0118607,  0.0121332,  0.0124114,  0.0126954,  0.0129852,
    0.013281,  0.0135828,  0.0138908,  0.014205,  0.0145256,  0.0148527,  0.0151863,  0.0155266,  0.0158738,  0.0162278,
    0.0165889,  0.0169571,  0.0173325,  0.0177153,  0.0181056,  0.0185035,  0.0189091,  0.0193225,  0.0197439,  0.0201734,
    0.020611,  0.021057,  0.0215114,  0.0219744,  0.0224461,  0.0229267,  0.0234161,  0.0239147,  0.0244224,  0.0249395,
    0.025466,  0.0260022,  0.026548,  0.0271038,  0.0276695,  0.0282453,  0.0288314,  0.0294279,  0.030035,  0.0306527,
    0.0312811,  0.0319205,  0.032571,  0.0332327,  0.0339057,  0.0345902,  0.0352863,  0.0359942,  0.0367139,  0.0374456,
    0.0381895,  0.0389457,  0.0397143,  0.0404955,  0.0412893,  0.042096,  0.0429156,  0.0437483,  0.0445943,  0.0454536,
    0.0463263,  0.0472127,  0.0481128,  0.0490267,  0.0499547,  0.0508968,  0.0518531,  0.0528237,  0.0538088,  0.0548086,
    0.055823,  0.0568523,  0.0578965,  0.0589557,  0.0600302,  0.0611199,  0.0622249,  0.0633455,  0.0644816,  0.0656334,
    0.0668009,  0.0679844,  0.0691838,  0.0703992,  0.0716308,  0.0728785,  0.0741426,  0.075423,  0.0767198,  0.0780332,
    0.0793631,  0.0807096,  0.0820728,  0.0834528,  0.0848496,  0.0862631,  0.0876936,  0.089141,  0.0906053,  0.0920865,
    0.0935848,  0.0951001,  0.0966324,  0.0981818,  0.0997482,  0.101332,  0.102932,  0.10455,  0.106184,  0.107836,
    0.109504,  0.111189,  0.112892,  0.114611,  0.116346,  0.118099,  0.119868,  0.121654,  0.123456,  0.125275,
    0.12711,  0.128962,  0.130829,  0.132713,  0.134612,  0.136527,  0.138458,  0.140405,  0.142366,  0.144344,
    0.146336,  0.148343,  0.150364,  0.152401,  0.154451,  0.156516,  0.158595,  0.160688,  0.162794,  0.164913,
    0.167045,  0.169191,  0.171348,  0.173519,  0.175701,  0.177895,  0.1801,  0.182317,  0.184545,  0.186783,
    0.189031,  0.19129,  0.193558,  0.195835,  0.198122,  0.200417,  0.20272,  0.205031,  0.20735,  0.209676,
    0.212008,  0.214347,  0.216692,  0.219042,  0.221398,  0.223758,  0.226123,  0.228491,  0.230863,  0.233237,
    0.235614,  0.237993,  0.240374,  0.242756,  0.245138,  0.24752,  0.249902,  0.252283,  0.254663,  0.25704,
    0.259416,  0.261788,  0.264157,  0.266522,  0.268882,  0.271237,  0.273586,  0.27593,  0.278266,  0.280596,
    0.282917,  0.28523,  0.287534,  0.289829,  0.292113,  0.294387,  0.296649,  0.2989,  0.301138,  0.303364,
    0.305576,  0.307773,  0.309956,  0.312124,  0.314276,  0.316411,  0.31853,  0.320631,  0.322713,  0.324777,
    0.326822,  0.328847,  0.330851,  0.332835,  0.334796,  0.336736,  0.338653,  0.340547,  0.342417,  0.344262,
    0.346083,  0.347879,  0.349648,  0.351391,  0.353107,  0.354796,  0.356456,  0.358088,  0.359691,  0.361265,
    0.362809,  0.364322,  0.365804,  0.367255,  0.368675,  0.370061,  0.371416,  0.372737,  0.374025,  0.375278,
    0.376498,  0.377683,  0.378832,  0.379947,  0.381025,  0.382068,  0.383074,  0.384043,  0.384975,  0.385869,
    0.386726,  0.387545,  0.388326,  0.389068,  0.389771,  0.390436,  0.391061,  0.391647,  0.392194,  0.3927,
    0.393167,  0.393594,  0.39398,  0.394326,  0.394632,  0.394897,  0.395122,  0.395305,  0.395448,  0.39555,
    0.395612,  0.395632,  0.395612,  0.39555,  0.395448,  0.395305,  0.395122,  0.394897,  0.394632,  0.394326,
    0.39398,  0.393594,  0.393167,  0.3927,  0.392194,  0.391647,  0.391061,  0.390436,  0.389771,  0.389068,
    0.388326,  0.387545,  0.386726,  0.385869,  0.384975,  0.384043,  0.383074,  0.382068,  0.381025,  0.379947,
    0.378832,  0.377683,  0.376498,  0.375278,  0.374025,  0.372737,  0.371416,  0.370061,  0.368675,  0.367255,
    0.365804,  0.364322,  0.362809,  0.361265,  0.359691,  0.358088,  0.356456,  0.354796,  0.353107,  0.351391,
    0.349648,  0.347879,  0.346083,  0.344262,  0.342417,  0.340547,  0.338653,  0.336736,  0.334796,  0.332835,
    0.330851,  0.328847,  0.326822,  0.324777,  0.322713,  0.320631,  0.31853,  0.316411,  0.314276,  0.312124,
    0.309956,  0.307773,  0.305576,  0.303364,  0.301138,  0.2989,  0.296649,  0.294387,  0.292113,  0.289829,
    0.287534,  0.28523,  0.282917,  0.280596,  0.278266,  0.27593,  0.273586,  0.271237,  0.268882,  0.266522,
    0.264157,  0.261788,  0.259416,  0.25704,  0.254663,  0.252283,  0.249902,  0.24752,  0.245138,  0.242756,
    0.240374,  0.237993,  0.235614,  0.233237,  0.230863,  0.228491,  0.226123,  0.223758,  0.221398,  0.219042,
    0.216692,  0.214347,  0.212008,  0.209676,  0.20735,  0.205031,  0.20272,  0.200417,  0.198122,  0.195835,
    0.193558,  0.19129,  0.189031,  0.186783,  0.184545,  0.182317,  0.1801,  0.177895,  0.175701,  0.173519,
    0.171348,  0.169191,  0.167045,  0.164913,  0.162794,  0.160688,  0.158595,  0.156516,  0.154451,  0.152401,
    0.150364,  0.148343,  0.146336,  0.144344,  0.142366,  0.140405,  0.138458,  0.136527,  0.134612,  0.132713,
    0.130829,  0.128962,  0.12711,  0.125275,  0.123456,  0.121654,  0.119868,  0.118099,  0.116346,  0.114611,
    0.112892,  0.111189,  0.109504,  0.107836,  0.106184,  0.10455,  0.102932,  0.101332,  0.0997482,  0.0981818,
    0.0966324,  0.0951001,  0.0935848,  0.0920865,  0.0906053,  0.089141,  0.0876936,  0.0862631,  0.0848496,  0.0834528,
    0.0820728,  0.0807096,  0.0793631,  0.0780332,  0.0767198,  0.075423,  0.0741426,  0.0728785,  0.0716308,  0.0703992,
    0.0691838,  0.0679844,  0.0668009,  0.0656334,  0.0644816,  0.0633455,  0.0622249,  0.0611199,  0.0600302,  0.0589557,
    0.0578965,  0.0568523,  0.055823,  0.0548086,  0.0538088,  0.0528237,  0.0518531,  0.0508968,  0.0499547,  0.0490267,
    0.0481128,  0.0472127,  0.0463263,  0.0454536,  0.0445943,  0.0437483,  0.0429156,  0.042096,  0.0412893,  0.0404955,
    0.0397143,  0.0389457,  0.0381895,  0.0374456,  0.0367139,  0.0359942,  0.0352863,  0.0345902,  0.0339057,  0.0332327,
    0.032571,  0.0319205,  0.0312811,  0.0306527,  0.030035,  0.0294279,  0.0288314,  0.0282453,  0.0276695,  0.0271038,
    0.026548,  0.0260022,  0.025466,  0.0249395,  0.0244224,  0.0239147,  0.0234161,  0.0229267,  0.0224461,  0.0219744,
    0.0215114,  0.021057,  0.020611,  0.0201734,  0.0197439,  0.0193225,  0.0189091,  0.0185035,  0.0181056,  0.0177153,
    0.0173325,  0.0169571,  0.0165889,  0.0162278,  0.0158738,  0.0155266,  0.0151863,  0.0148527,  0.0145256,  0.014205,
    0.0138908,  0.0135828,  0.013281,  0.0129852,  0.0126954,  0.0124114,  0.0121332,  0.0118607,  0.0115937,  0.0113321,
    0.0110759,  0.010825,  0.0105793,  0.0103386,  0.010103,  0.00987221,  0.00964628,  0.00942507,  0.00920851,  0.00899652,
    0.008789,  0.00858587,  0.00838706,  0.00819248,  0.00800206,  0.00781571,  0.00763337,  0.00745495,  0.00728038,  0.00710959,
    0.00694251,  0.00677906,  0.00661918,  0.00646279,  0.00630983,  0.00616023,  0.00601393,  0.00587086,  0.00573095,  0.00559415,
    0.00546039,  0.00532962,  0.00520176,  0.00507677,  0.00495459,  0.00483516,  0.00471842,  0.00460431,  0.0044928,  0.00438381,
    0.00427731,  0.00417323,  0.00407153,  0.00397216,  0.00387508,  0.00378022,  0.00368755,  0.00359702,  0.00350859,  0.0034222,
    0.00333782,  0.00325541,  0.00317492,  0.00309631,  0.00301954,  0.00294457,  0.00287137,  0.00279989,  0.00273009,  0.00266195,
    0.00259542,  0.00253046,  0.00246706,  0.00240516,  0.00234473,  0.00228576,  0.00222819,  0.002172,  0.00211717,  0.00206365,
    0.00201142,  0.00196046,  0.00191072,  0.00186219,  0.00181484,  0.00176864,  0.00172356,  0.00167959,  0.00163668,  0.00159483,
    0.001554,  0.00151417,  0.00147532,  0.00143743,  0.00140047,  0.00136442,  0.00132927,  0.00129498,  0.00126154,  0.00122894,
    0.00119714,  0.00116614,  0.00113591,  0.00110643,  0.00107769,  0.00104967,  0.00102235,  0.000995717,  0.000969754,  0.000944444,
    0.000919772,  0.000895722,  0.00087228,  0.000849431,  0.00082716,  0.000805454,  0.000784299,  0.000763682,  0.00074359,  0.00072401,
    0.000704929,  0.000686335,  0.000668217,  0.000650563,  0.000633361,  0.0006166,  0.00060027,  0.00058436,  0.00056886,  0.000553759,
    0.000539048,  0.000524716,  0.000510756,  0.000497156,  0.000483909,  0.000471006,  0.000458437,  0.000446195,  0.000434272,  0.000422659,
    0.000411349,  0.000400334,  0.000389606,  0.000379159,  0.000368986,  0.000359079,  0.000349431,  0.000340037,  0.00033089,  0.000321983,
    0.00031331,  0.000304866,  0.000296644,  0.00028864,  0.000280846,  0.000273259,  0.000265872,  0.000258681,  0.00025168,  0.000244865,
    0.000238231,  0.000231773,  0.000225486,  0.000219367,  0.000213411,  0.000207613,  0.00020197,  0.000196478,  0.000191132,  0.000185929,
    0.000180865,  0.000175937,  0.00017114,  0.000166472,  0.00016193,  0.000157509,  0.000153207,  0.00014902,  0.000144947,  0.000140982,
    0.000137125,  0.000133371,  0.000129719,  0.000126165,  0.000122707,  0.000119342,  0.000116069,  0.000112884,  0.000109785,  0.00010677,
    0.000103837,  0.000100983,  9.82065e-05,  9.55055e-05,  9.28778e-05,  9.03215e-05,  8.78347e-05,  8.54155e-05,  8.30622e-05,  8.07729e-05,
    7.8546e-05,  7.63798e-05,  7.42727e-05,  7.2223e-05,  7.02293e-05,  6.82901e-05,  6.64038e-05,  6.45691e-05,  6.27846e-05,  6.10489e-05,
    5.93607e-05,  5.77187e-05,  5.61217e-05,  5.45685e-05,  5.30579e-05,  5.15888e-05,  5.01599e-05,  4.87703e-05,  4.74189e-05,  4.61046e-05,
    4.48264e-05,  4.35834e-05,  4.23746e-05,  4.11991e-05,  4.00559e-05,  3.89442e-05,  3.78631e-05,  3.68119e-05,  3.57896e-05,  3.47955e-05,
    3.38289e-05,  3.28889e-05};

  // Handle bad data first
  if (degFree != 30)
    return ((double) -1);

  // Simple cases...
  if (x <= -5)
    return ((double) 0.0);
  if (x >= 5)
    return ((double) 0.0);

  // Not simple, do the lookup and interpolation

  return(interpolate (x, TBL_VALUES, X, Y));
}


#include <gsl/gsl_randist.h>
#include <gsl/gsl_cdf.h>

int main (int argc, char *argv[]) {
  double x, mean, stdDev, degFree;

  /*
  stdDev = atof (argv[1]);
  for (x = -1.0; x < 1.0; x += .0001)
    printf ("%g %g %g\n", x, gaussian_cdf (x, (double)0.0, stdDev), gsl_cdf_gaussian_P (x, stdDev));
  */
  degFree = atof (argv[1]);
  for (x = -5.0; x < 5.0; x += .0001)
    printf ("%g %g %g\n", x, t_pdf (x, degFree), gsl_ran_tdist_pdf (x, degFree));
}


