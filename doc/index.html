<h2>INTRODUCTION</h2>
kelvin is an ANSI C implementation of the Elston-Stewart algorithm for linkage
analysis. It currently supports two-point and multipoint analyses, dichotomous and
quantitative traits, linkage equalibrium and disequalibrium, case control, and many
other options. It is copyright 2008, Nationwide Children's Research Institute. All
rights reserved. Permission is hereby given to use this software for non-profit
educational purposes only.
<h2>BUILDING THE PROGRAMS</h2>
<h3>Requirements</h3>
<h4>Platforms</h4>
kelvin is written in ANSI C and should build correctly on most platforms. 
kelvin releases are currently tested under the following platforms:
<ul>
<li>Redhat Enterprise Linux x86_64 with GCC 4.1.1
<li>Debian Linux i386 with GCC 4.1.1
<li>Macintosh OSX 10.4 i386 with GCC 4.0.1 (no OpenMP) and GCC 4.3.0
<li>Macintosh OSX 10.4 PowerMac with GCC 4.0.1 (no OpenMP)
<li>Cygwin under Windows XP i386 with GCC 3.4.4 (cygming special)
</ul>
We don't know of any reason why it shouldn't run on any platform supported by GNU CC and the GNU Scientific
Library, so if you encounter incompatabilities, please let us know.

<h4>Libraries</h4>
kelvin currently only requires the <a href="http://www.gnu.org/software/gsl/">GNU Scientific Library</a>
(GSL), a free numerical library for C and C++. Make a note of the location of the library and include
files so that you can modify the kelvin Makefile if necessary.
<p>
When kelvin is run in polynomial mode, it makes very extensive use of memory management, and can, under most
circumstances, definitely benefit from a drop-in allocator such as <a href="http://www.hoard.org/">hoard</a>
or <a href="http://www.malloc.de/en/">ptmalloc3</a>. Either of these can easily halve execution time, and will
keep memory fragmentation down when running in mult-threaded mode, but they are not required.

<h4>Resources</h4>
kelvin's resource requirements vary wildly depending upon the complexity of the analysis
being performed. In general, the memory requirements are negligible unless you use polynomial
mode (PE in the configuration file) to speed-up calculations. The idea of peeding-up calculations can become
quite attractive, as some seemingly simple analyses can involve millions of iterations and
take literally months to run.
Polynomial mode can reduce
runtime by several orders of magnitude, but can also easily exceed 16Gb of memory for
complex pedigrees or those with untyped founders. The best approach is probably to normally use
polynomial mode and fall-back to non-polynomial mode if memory becomes an issue.
<p>
If you are running on a mult-core platform, and your compiler supports OpenMP 2.0, you can build kelvin
to use multiple threads and reduce your runtime significantly at a marginal increase in memory, less if
you use a drop-in allocator as described above.
<h3>Installation</h3>
kelvin is currently distributed as a compressed tarball of the directory hierarchy of our
latest release, e.g. kelvin-0.34.2.tar.gz. 
<h4>Directory Structure</h4>
<ul>
<li>./ - kelvin and dkelvin main programs. Includes several varieties of the master Makefile.
<li>doc - (very) limited documentation.
<li>include - a work directory for builds.
<li>lib - a work directory for builds.
<li>pedlib - pedigree, likelihood, and polynomial components. Includes a dependent Makefile - don't try
to use it by itself.
<li>test-suite - analyses that can be used for build validation as well as configuration examples.
<li>utils - general-purpose utility components. Includes a dependent Makefile.
</ul>

<h4>Building</h4>
Edit the master Makefile to specify the location of the gsl libraries and include files on your system.
If you do not have an OpenMP-capable compiler, comment-out the lines that reference "-fopenmp" as indicated
in the Makefile comments. Type "make clean" and then "make" and keep your fingers crossed.
<h4>Testing</h4>

<h2>PREPARING YOUR CONFIGURATION FILE</h2>
kelvin takes all of its configuration information from a single file specified on the command line.
This file is composed of directives that describe the linkage analysis to be performed, and the locations
of supporting data files.
Extensive information on the directives used in the kelvin configuration file is provided in doc/ReadMe.conf.
<p>
kelvin provides such a wide variety of options for linkage analysis that it can be confusing to
determine what combinations of directives are appropriate. <a href="config.gif">This chart</a>
illustrates the thirteen current configuration "paths" for kelvin, and the directives they use.
In addition to those that are specific to a particular type of analysis, the following directives can
be used for any analysis:
<ul>
<li>all data file-specification directives, such as PD, DF, MK, MP, LP, OF, HE and PPL
<li>all value description directives, such as UP and AS
<li>Gene frequency (GF)
<li>Penetrance directives (DD, Dd, dd, etc.)
<li>X-chromosome analysis (XC) as opposed to allosomes.
<li>Alpha (AL)
<li>Polynomial evaluation (PE)
</ul>

The distribution includes subdirectories with sample configuration files for a few of
the configuration "paths".
These illustrate the required configuration information, and can serve as starting points for your own
versions.
<ol>
<li>TP, DT, LD - 
<li>TP, DT, LD, CF - 
<li>TP, DT, LE -
<li>TP, DT, MM, LD -
<li>TP, DT, MM, LD, CF -
<li>TP, DT, MM, LE -
<li>TP, QT, LE - test-suite/distrib/TP_QT_LE/kelvin.conf
<li>TP, QT, LD - test-suite/distrib/TP_QT_LD/kelvin.conf
<li>TP, CT, LE -
<li>TP, CT, LD -
<li>MP, DT -
<li>MP, QT -
<li>MP, CT -
</ol>

<h2>RUNNING THE PROGRAMS</h2>

<h3>Estimating Runtime</h3>



<h2>INTERPRETING THE RESULTS</h2>
